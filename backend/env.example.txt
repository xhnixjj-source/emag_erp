# ============================================
# 代理配置 (lunaproxy 动态 IP 代理)
# 使用说明：复制此文件为 .env 并根据实际情况修改
# ============================================

# 是否启用代理（true/false）
PROXY_ENABLED=true

# lunaproxy 动态 IP API URL
PROXY_API_URL=https://tq.lunaproxy.com/get_dynamic_ip

# lunaproxy 用户 ID（neek 参数），从 lunaproxy 控制台获取
PROXY_API_USER_ID=1866167

# 代理地区，all 表示全球，可指定如 "ro" 表示罗马尼亚
PROXY_API_COUNTRY=all

# 每次 API 请求获取的 IP 数量
PROXY_API_IP_COUNT=10

# IP 有效期（分钟），lunaproxy 的 ip_si 参数：1-120 分钟
PROXY_API_IP_SI=6

# 分隔符参数，空字符串表示每行一个 IP:PORT
PROXY_API_SB=

# API 刷新间隔（秒），建议 60-120 秒以保持 IP 池新鲜
# 应小于 PROXY_API_IP_SI（IP有效期）换算成秒数
PROXY_API_FETCH_INTERVAL=60

# API 请求超时（秒）
PROXY_API_TIMEOUT=10

# 代理验证超时（秒）
PROXY_VALIDATION_TIMEOUT=5

# 静态代理列表（可选，格式：ip:port,ip:port,...）
# 如果设置了 PROXY_API_URL，会自动从 API 获取，无需手动配置
PROXY_LIST=

# ============================================
# 爬虫配置
# ============================================

# 爬虫延迟（秒）
CRAWLER_DELAY_MIN=1
CRAWLER_DELAY_MAX=3

# 爬虫超时（秒）
CRAWLER_TIMEOUT=60

# 最大重试次数
MAX_RETRY_COUNT=5

# ============================================
# Playwright 配置
# ============================================

# 浏览器类型
PLAYWRIGHT_BROWSER_TYPE=chromium
# 是否无头模式
PLAYWRIGHT_HEADLESS=true

# 超时设置（毫秒）
PLAYWRIGHT_TIMEOUT=30000
PLAYWRIGHT_NAVIGATION_TIMEOUT=30000

# 最大浏览器上下文数量
PLAYWRIGHT_MAX_CONTEXTS=10

# ============================================
# BitBrowser 配置（可选）
# ============================================
#
# 说明：
# - 当 BITBROWSER_ENABLED=true 时，系统会通过 BitBrowser 窗口 + CDP 进行爬取
# - 推荐使用 BITBROWSER_GROUP_ID 指定一个窗口组，系统启动时自动拉取该组下所有窗口
# - 如果不设置 GROUP_ID，则 fallback 到手动指定 BITBROWSER_WINDOW_IDS
#
# 是否启用 BitBrowser 模式（true/false）
BITBROWSER_ENABLED=false

# BitBrowser 本地 API 地址（默认 127.0.0.1:54345）
BITBROWSER_API_URL=http://127.0.0.1:54345

# 窗口组 ID（推荐）——在 BitBrowser 中创建一个窗口组，把要用于爬虫的窗口都放进该组
# 系统会调用 /browser/list?groupId=xxx 自动获取组内所有窗口 ID
BITBROWSER_GROUP_ID=

# 窗口 ID 列表（手动 fallback，逗号分隔，如：abc123,def456）
# 仅在 BITBROWSER_GROUP_ID 为空时生效
BITBROWSER_WINDOW_IDS=

# 单个窗口最大重启次数
BITBROWSER_MAX_RESTART_COUNT=10

# 两次重启之间的最小间隔（秒）
BITBROWSER_RESTART_DELAY=5

# ============================================
# 数据库配置
# ============================================

DATABASE_URL=sqlite:///./emag_erp.db

# ============================================
# 使用说明
# ============================================
# 
# 1. 复制此文件为 .env：cp env.example.txt .env
# 2. 根据实际情况修改配置
#
# === 代理模式（默认） ===
# 3. 确保 Proxifier 已配置并运行（见 docs/proxifier_setup_guide.md）
# 4. 启动 VPN 确保海外 IP 出口
# 5. 运行测试脚本验证：python scripts/test_api_proxy_to_emag.py
#
# === BitBrowser 模式（可选） ===
# 3. 安装并打开 BitBrowser 客户端
# 4. 在 BitBrowser 中创建浏览器窗口，每个窗口配置好代理
# 5. 创建一个窗口组，把爬虫要用的窗口都放进去
# 6. 将窗口组 ID 填入 BITBROWSER_GROUP_ID（推荐）
#    或将各窗口 ID 逐个填入 BITBROWSER_WINDOW_IDS（逗号分隔）
# 7. 设置 BITBROWSER_ENABLED=true
# 8. 启动系统后，爬虫会自动通过 BitBrowser 窗口 + CDP 进行爬取
#

